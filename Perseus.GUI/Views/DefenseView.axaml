<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:Perseus.GUI.ViewModels"
             x:Class="Perseus.GUI.Views.DefenseView"
             x:DataType="vm:DefenseViewModel">

  <Design.DataContext>
    <vm:DefenseViewModel />
  </Design.DataContext>

  <ScrollViewer>
    <StackPanel Margin="24" Spacing="24">
      
      <!-- Header -->
      <StackPanel Spacing="8">
        <TextBlock Text="🛡️ Modo Defense (Blue Team)" 
                   FontSize="24" 
                   FontWeight="Bold" 
                   Foreground="#3182CE"/>
        <TextBlock Text="Monitoramento de rede, detecção de anomalias e resposta a incidentes" 
                   FontSize="14" 
                   Foreground="#718096"/>
      </StackPanel>

      <!-- Configuration Panel -->
      <Border Background="#F7FAFC" 
              CornerRadius="8" 
              Padding="20">
        <StackPanel Spacing="16">
          <TextBlock Text="Configuração do Monitoramento" 
                     FontSize="16" 
                     FontWeight="SemiBold" 
                     Foreground="#2D3748"/>
          
          <Grid ColumnDefinitions="*,*" Spacing="16">
            
            <!-- Network Range -->
            <StackPanel Grid.Column="0" Spacing="4">
              <TextBlock Text="Rede para Monitorar" FontWeight="SemiBold"/>
              <TextBox Text="{Binding NetworkRange}" 
                       Watermark="192.168.1.0/24"
                       IsEnabled="{Binding !IsMonitoring}"/>
              <TextBlock Text="Especifique a rede em notação CIDR" 
                         FontSize="11" 
                         Foreground="#718096"/>
            </StackPanel>

            <!-- Monitoring Interval -->
            <StackPanel Grid.Column="1" Spacing="4">
              <TextBlock Text="Intervalo (segundos)" FontWeight="SemiBold"/>
              <NumericUpDown Value="{Binding MonitoringInterval}" 
                             Minimum="30" 
                             Maximum="3600" 
                             Increment="30"
                             IsEnabled="{Binding !IsMonitoring}"/>
              <TextBlock Text="Frequência das verificações" 
                         FontSize="11" 
                         Foreground="#718096"/>
            </StackPanel>
          </Grid>

          <!-- Control Buttons -->
          <StackPanel Orientation="Horizontal" Spacing="12">
            <Button Content="🟢 Iniciar Monitoramento" 
                    Command="{Binding StartMonitoringCommand}"
                    Background="#38A169" 
                    Foreground="White" 
                    Padding="16,8"
                    IsEnabled="{Binding !IsMonitoring}"/>
            <Button Content="🔴 Parar Monitoramento" 
                    Command="{Binding StopMonitoringCommand}"
                    Background="#E53E3E" 
                    Foreground="White" 
                    Padding="16,8"
                    IsEnabled="{Binding IsMonitoring}"/>
            <Button Content="📊 Criar Baseline" 
                    Command="{Binding CreateBaselineCommand}"
                    Background="#805AD5" 
                    Foreground="White" 
                    Padding="16,8"
                    IsEnabled="{Binding !IsMonitoring}"/>
          </StackPanel>

          <!-- Status -->
          <StackPanel Spacing="8">
            <TextBlock Text="{Binding MonitoringStatus}" 
                       FontWeight="SemiBold" 
                       Foreground="#2D3748"/>
            <ProgressBar IsIndeterminate="{Binding IsMonitoring}" 
                         Height="6"
                         IsVisible="{Binding IsMonitoring}"/>
          </StackPanel>
        </StackPanel>
      </Border>

      <!-- Alerts Panel -->
      <Border Background="White" 
              CornerRadius="8" 
              Padding="20"
              BorderBrush="#E2E8F0"
              BorderThickness="1">
        <StackPanel Spacing="16">
          <Grid ColumnDefinitions="*,Auto,Auto">
            <TextBlock Grid.Column="0"
                       Text="Alertas de Segurança" 
                       FontSize="16" 
                       FontWeight="SemiBold" 
                       Foreground="#2D3748"/>
            <TextBlock Grid.Column="1"
                       Text="{Binding Alerts.Count, StringFormat='{0} alertas'}" 
                       FontSize="12" 
                       Foreground="#718096"
                       VerticalAlignment="Center"
                       Margin="0,0,12,0"/>
            <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="8">
              <Button Content="🗑️ Limpar" 
                      Command="{Binding ClearAlertsCommand}"
                      Background="#718096" 
                      Foreground="White" 
                      Padding="8,4"
                      FontSize="12"/>
              <Button Content="💾 Exportar" 
                      Command="{Binding ExportAlertsCommand}"
                      Background="#3182CE" 
                      Foreground="White" 
                      Padding="8,4"
                      FontSize="12"/>
            </StackPanel>
          </Grid>

          <DataGrid ItemsSource="{Binding Alerts}"
                    AutoGenerateColumns="False"
                    GridLinesVisibility="Horizontal"
                    HeadersVisibility="Column"
                    IsReadOnly="True"
                    Height="200">
            <DataGrid.Columns>
              <DataGridTextColumn Header="Timestamp" Binding="{Binding Timestamp, StringFormat='HH:mm:ss'}" Width="80"/>
              <DataGridTextColumn Header="Severidade" Binding="{Binding Severity}" Width="80"/>
              <DataGridTextColumn Header="Tipo" Binding="{Binding Type}" Width="120"/>
              <DataGridTextColumn Header="Host" Binding="{Binding Host}" Width="120"/>
              <DataGridTextColumn Header="Descrição" Binding="{Binding Description}" Width="300"/>
              <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="80"/>
            </DataGrid.Columns>
          </DataGrid>
        </StackPanel>
      </Border>

      <!-- Monitoring Events Panel -->
      <Border Background="White" 
              CornerRadius="8" 
              Padding="20"
              BorderBrush="#E2E8F0"
              BorderThickness="1">
        <StackPanel Spacing="16">
          <Grid ColumnDefinitions="*,Auto">
            <TextBlock Grid.Column="0"
                       Text="Eventos de Monitoramento" 
                       FontSize="16" 
                       FontWeight="SemiBold" 
                       Foreground="#2D3748"/>
            <TextBlock Grid.Column="1"
                       Text="{Binding MonitoringResults.Count, StringFormat='{0} eventos'}" 
                       FontSize="12" 
                       Foreground="#718096"
                       VerticalAlignment="Center"/>
          </Grid>

          <DataGrid ItemsSource="{Binding MonitoringResults}"
                    AutoGenerateColumns="False"
                    GridLinesVisibility="Horizontal"
                    HeadersVisibility="Column"
                    IsReadOnly="True"
                    Height="250">
            <DataGrid.Columns>
              <DataGridTextColumn Header="Timestamp" Binding="{Binding Timestamp, StringFormat='HH:mm:ss'}" Width="80"/>
              <DataGridTextColumn Header="Host" Binding="{Binding Host}" Width="120"/>
              <DataGridTextColumn Header="Hostname" Binding="{Binding Hostname}" Width="150"/>
              <DataGridTextColumn Header="Tipo de Evento" Binding="{Binding EventType}" Width="150"/>
              <DataGridTextColumn Header="Detalhes" Binding="{Binding Details}" Width="300"/>
            </DataGrid.Columns>
          </DataGrid>
        </StackPanel>
      </Border>

    </StackPanel>
  </ScrollViewer>
</UserControl>

